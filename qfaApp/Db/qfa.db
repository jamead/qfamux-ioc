record(bi, "$(P){$(NO)}:conn") {
  field(DTYP, "PSC Ctrl Connected")
  field(INP , "@pscudp$(NO)")
  field(SCAN, "I/O Intr")
  field(ZNAM, "Disconnected")
  field(ONAM, "Connected")
  field(ZSV , "MAJOR")
}

record(bo, "$(P){$(NO)}:reconn") {
  field(DTYP, "PSC Ctrl Reconnect")
  field(OUT , "@pscudp$(NO)")
  field(ZNAM, "Reconnect")
  field(ONAM, "Reconnect")
}


# flush send to socket
record(bo, "$(P){$(NO)}:send") {
  field(DTYP, "PSC Ctrl Send All")
  field(OUT , "@pscudp$(NO)")
  field(ZNAM, "Send")
  field(ONAM, "Send")
}

# writes the UDP packet to the PDU to get status (1Hz)
record(stringout, "$(P){$(NO)}:speak") {
  field(VAL, "Status")        
  field(DTYP, "PSC Block")
  field(OUT , "@pscudp$(NO) 100")   
  field(FLNK, "$(P){$(NO)}:send")
  #field(SCAN, "1 second")
}

# writes the UDP packet to the PDU to get status (1Hz)
record(longout, "$(P){$(NO)}:kick") {
  field(VAL, "21776")        
  field(DTYP, "PSC Single I32")
  field(OUT , "@pscudp$(NO) 100 21776")   
  field(FLNK, "$(P){$(NO)}:send")
  field(SCAN, "1 second")
}





# writes the UDP packet to the PDU
record(stringout, "$(P){$(NO)}Ch1:State-SP") {
  field(DTYP, "PSC Block")
  field(OUT , "@pscudp$(NO) 100")  
  field(FLNK, "$(P){$(NO)}:send")
}

# writes the UDP packet to the PDU
record(stringout, "$(P){$(NO)}Ch2:State-SP") {
  field(DTYP, "PSC Block")
  field(OUT , "@pscudp$(NO) 100")  
  field(FLNK, "$(P){$(NO)}:send")
}

# writes the UDP packet to the PDU
record(stringout, "$(P){$(NO)}Ch3:State-SP") {
  field(DTYP, "PSC Block")
  field(OUT , "@pscudp$(NO) 100")  
  field(FLNK, "$(P){$(NO)}:send")
}

# writes the UDP packet to the PDU
record(stringout, "$(P){$(NO)}Ch4:State-SP") {
  field(DTYP, "PSC Block")
  field(OUT , "@pscudp$(NO) 100")  
  field(FLNK, "$(P){$(NO)}:send")
}

record(stringout, "$(P){$(NO)}All:On-SP") {
  field(VAL, "ALL-ON")        
  field(DTYP, "PSC Block")
  field(OUT , "@pscudp$(NO) 100")   
  field(FLNK, "$(P){$(NO)}:send")
}

record(stringout, "$(P){$(NO)}All:Off-SP") {
  field(VAL, "ALL-OFF")        
  field(DTYP, "PSC Block")
  field(OUT , "@pscudp$(NO) 100")   
  field(FLNK, "$(P){$(NO)}:send")
}



## 20 word status from QFA

record(ai, "$(P){$(NO)}Frame:Start-I") {
    field(DTYP, "PSC Reg F32")
    field(INP , "@pscudp$(NO) 15 0")
    field(SCAN,"I/O Intr")
}

record(ai,"$(P){$(NO)}Ch1:Current-I"){
    field(DTYP, "PSC Reg F32")
    field(INP , "@pscudp$(NO) 15 4")
    field(SCAN,"I/O Intr")
}

record(ai,"$(P){$(NO)}Ch2:Current-I"){
    field(DTYP, "PSC Reg F32")
    field(INP , "@pscudp$(NO) 15 8")
    field(SCAN,"I/O Intr")
}

record(ai,"$(P){$(NO)}Ch3:Current-I"){
    field(DTYP, "PSC Reg F32")
    field(INP , "@pscudp$(NO) 15 12")
    field(SCAN,"I/O Intr")
}

record(ai,"$(P){$(NO)}Ch4:Current-I"){
    field(DTYP, "PSC Reg F32")
    field(INP , "@pscudp$(NO) 15 16")
    field(SCAN,"I/O Intr")
}

record(ai,"$(P){$(NO)}Ch1:Cmd-I"){
    field(DTYP, "PSC Reg F32")
    field(INP , "@pscudp$(NO) 15 20")
    field(SCAN,"I/O Intr")
}

record(ai,"$(P){$(NO)}Ch2:Cmd-I"){
    field(DTYP, "PSC Reg F32")
    field(INP , "@pscudp$(NO) 15 24")
    field(SCAN,"I/O Intr")
}

record(ai,"$(P){$(NO)}Ch3:Cmd-I"){
    field(DTYP, "PSC Reg F32")
    field(INP , "@pscudp$(NO) 15 28")
    field(SCAN,"I/O Intr")
}

record(ai,"$(P){$(NO)}Ch4:Cmd-I"){
    field(DTYP, "PSC Reg F32")
    field(INP , "@pscudp$(NO) 15 32")
    field(SCAN,"I/O Intr")
}

record(ai,"$(P){$(NO)}Pwr:P15V-I"){
    field(DTYP, "PSC Reg F32")
    field(INP , "@pscudp$(NO) 15 36")
    field(SCAN,"I/O Intr")
}

record(ai,"$(P){$(NO)}Pwr:N15V-I"){
    field(DTYP, "PSC Reg F32")
    field(INP , "@pscudp$(NO) 15 40")
    field(SCAN,"I/O Intr")
}

record(ai,"$(P){$(NO)}Pwr:P12V-I"){
    field(DTYP, "PSC Reg F32")
    field(INP , "@pscudp$(NO) 15 44")
    field(SCAN,"I/O Intr")
}

record(ai,"$(P){$(NO)}Pwr:P5V-I"){
    field(DTYP, "PSC Reg F32")
    field(INP , "@pscudp$(NO) 15 48")
    field(SCAN,"I/O Intr")
}

record(ai,"$(P){$(NO)}Temp:Front-I"){
    field(DTYP, "PSC Reg F32")
    field(INP , "@pscudp$(NO) 15 52")
    field(SCAN,"I/O Intr")
}

record(ai,"$(P){$(NO)}Temp:Rear-I"){
    field(DTYP, "PSC Reg F32")
    field(INP , "@pscudp$(NO) 15 56")
    field(SCAN,"I/O Intr")
}

record(ai,"$(P){$(NO)}Ch1:Cal-I"){
    field(DTYP, "PSC Reg F32")
    field(INP , "@pscudp$(NO) 15 60")
    field(SCAN,"I/O Intr")
}

record(ai,"$(P){$(NO)}Ch2:Cal-I"){
    field(DTYP, "PSC Reg F32")
    field(INP , "@pscudp$(NO) 15 64")
    field(SCAN,"I/O Intr")
}

record(ai,"$(P){$(NO)}Ch3:Cal-I"){
    field(DTYP, "PSC Reg F32")
    field(INP , "@pscudp$(NO) 15 68")
    field(SCAN,"I/O Intr")
}

record(ai,"$(P){$(NO)}Ch4:Cal-I"){
    field(DTYP, "PSC Reg F32")
    field(INP , "@pscudp$(NO) 15 72")
    field(SCAN,"I/O Intr")
}


record(ai,"$(P){$(NO)}Frame:End-I"){
    field(DTYP, "PSC Reg F32")
    field(INP , "@pscudp$(NO) 15 76")
    field(SCAN,"I/O Intr")
}



record(mbbo, "$(P){$(NO)}Relay:Number") {
  field(DESC, "Relay select")
  field(DTYP, "Soft Channel")

  field(ZRST, "All Off")
  field(ONST, "Relay 1")
  field(TWST, "Relay 2")
  field(THST, "Relay 3")
  field(FRST, "Relay 4")
  field(FVST, "Relay 5")
  field(SXST, "Relay 6")

  field(ZRVL, "5510")  # 0x5510
  field(ONVL, 21777)  # 0x5511
  field(TWVL, "21778")  # 0x5512
  field(THVL, "21779")  # 0x5513
  field(FRVL, "21780")  # 0x5514
  field(FVVL, "21781")  # 0x5515
  field(SXVL, "21782")  # 0x5516
  field(FLNK, "$(P){$(NO)}Relay:KickDec.PROC")
  #field(FLNK, "$(P){$(NO)}:kick.PROC")
}


record(calcout, "$(P){$(NO)}Relay:KickDec") {
  field(DESC, "Copy Relay:Number.RVAL to :kick and send")
  field(INPA, "$(P){$(NO)}Relay:Number.RVAL NPP NMS")
  field(CALC, "A")
  field(OCAL, "A")
  field(OOPT, "Every Time")
  field(OUT,  "$(P){$(NO)}:kick.VAL PP")
}







